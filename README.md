# Property Management (Site Management System)

This project is a Spring Boot application for managing apartment/site operations. It exposes REST APIs for CRUD operations and relations of entities such as apartments, residents, properties, billings, dues, fixtures, and fixture fee shares. JTE template engine support is also included for the view layer.

## Features
- **Apartment Management**: Create, list, update, delete
- **Resident Management**: Create, list, update, delete
- **Property Management**: Full CRUD
- **Billing Management**: Full CRUD
- **Dues Management**: Full CRUD
- **Fixture Management**: Full CRUD
- **Fixture Fee & Share**: Full CRUD
- **Validation**: Request validation with `jakarta.validation`
- **JPA & PostgreSQL**: Persistence layer
- **JTE**: Template engine for the view layer

## Tech Stack
- Java 21
- Spring Boot 3.5.3 (Web, Data JPA, Validation, DevTools)
- PostgreSQL (JDBC driver)
- Lombok
- JTE (gg.jte)
- Maven

## Structure
```
property-management/
  ├── pom.xml
  ├── src/
  │   ├── main/
  │   │   ├── java/com/deveyk/property_management/
  │   │   │   ├── controller/(...)
  │   │   │   ├── dto/(...)
  │   │   │   ├── entity/(...)
  │   │   │   ├── repository/(...)
  │   │   │   ├── service/(...)
  │   │   │   └── PropertyManagementApplication.java
  │   │   ├── resources/
  │   │   │   ├── application.properties
  │   │   │   ├── templates/
  │   │   │   └── static/
  │   │   └── jte/
  │   └── test/
  └── mvnw, mvnw.cmd
```

## Prerequisites
- Java 21 (JDK 21)
- Maven 3.9+
- PostgreSQL 14+ (local)

## Setup
1) Clone the repository:
```bash
git clone <repo-url>
cd property-management
```
2) Download dependencies and build:
```bash
mvn clean package -DskipTests
```

## Configuration
Application configuration is in `src/main/resources/application.properties`.

Default database settings (adjust for your environment):
```properties
gg.jte.development-mode=true
spring.application.name=property-management

# database connection
spring.datasource.url=jdbc:postgresql://localhost:5432/postgres
spring.jpa.properties.hibernate.default_schema=property_db
spring.datasource.username=postgres
spring.datasource.password=User.2025

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
```
- Update `spring.datasource.url/username/password` for your local database.
- Ensure the schema (e.g., `property_db`) exists or remove the `default_schema` line.
- `ddl-auto=update` is convenient for development; prefer `validate` and migrations in production.

## Run
- With Maven:
```bash
mvn spring-boot:run
```
- With Jar:
```bash
java -jar target/property-management-0.0.1-SNAPSHOT.jar
```
- Default port: `8080`

## API
All endpoints use `application/json` under `/rest/api/...` base paths.

### Apartment
Base: `/rest/api/apartment`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

Example request (`POST /save`):
```json
{
  "number": "A12",
  "type": "2+1",
  "allotmentPercentage": 12.5,
  "residentId": 1
}
```

### Resident
Base: `/rest/api/resident`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

Example request (`POST /save`):
```json
{
  "name": "John Doe",
  "type": "Owner",
  "phone": "+90 555 000 00 00",
  "email": "john@doe.com",
  "dtoApartmentId": 1
}
```

### Property
Base: `/rest/api/property`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Billing
Base: `/rest/api/billings`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Dues
Base: `/rest/api/dues`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Fixture
Base: `/rest/api/fixture`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Fixture Fee
Base: `/rest/api/fixturefee`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Fixture Fee Share
Base: `/rest/api/fixturefeeshare`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

## Sample Request/Response
- Create apartment (cURL):
```bash
curl -X POST http://localhost:8080/rest/api/apartment/save \
  -H "Content-Type: application/json" \
  -d '{
    "number": "A12",
    "type": "2+1",
    "allotmentPercentage": 12.5,
    "residentId": 1
  }'
```
- Validation errors are handled by a global exception handler with readable messages.

## Development Tips
- `DevTools` enables automatic restarts on code changes.
- `spring.jpa.show-sql=true` helps you trace SQL logs.
- JTE templates live in `src/main/jte` and are generated by the Maven plugin during build.

## Tests
```bash
mvn test
```

## License
This project is for personal/learning purposes. Feel free to use it. Add a `LICENSE` file if you want a formal license.

## Author
- Erdem Yusuf

---

## Türkçe

# Property Management (Site Yönetim Sistemi)

Bu proje, apartman/site yönetimi süreçlerini yönetmek için geliştirilmiş bir Spring Boot uygulamasıdır. Proje; daire, sakin, mülk, fatura, aidat, demirbaş ve demirbaş gider payı gibi varlıkların CRUD işlemlerini ve ilişkilerini REST API üzerinden sunar. Görsel taraf için JTE şablon motoru desteği de mevcuttur.

## Özellikler
- **Daire Yönetimi**: Daire oluşturma, listeleme, güncelleme, silme
- **Sakin Yönetimi**: Sakin oluşturma, listeleme, güncelleme, silme
- **Mülk (Property) Yönetimi**: CRUD işlemleri
- **Fatura (Billing) Yönetimi**: CRUD işlemleri
- **Aidat (Dues) Yönetimi**: CRUD işlemleri
- **Demirbaş (Fixture) Yönetimi**: CRUD işlemleri
- **Demirbaş Gider Payı (FixtureFee, FixtureFeeShare)**: CRUD işlemleri
- **Validation**: `jakarta.validation` ile istek doğrulama
- **JPA & PostgreSQL**: Kalıcı veri katmanı
- **JTE**: Sunum katmanı için şablon motoru

## Teknoloji Yığını
- Java 21
- Spring Boot 3.5.3 (Web, Data JPA, Validation, DevTools)
- PostgreSQL (JDBC driver)
- Lombok
- JTE (gg.jte)
- Maven

## Dizim
```
property-management/
  ├── pom.xml
  ├── src/
  │   ├── main/
  │   │   ├── java/com/deveyk/property_management/
  │   │   │   ├── controller/(...)
  │   │   │   ├── dto/(...)
  │   │   │   ├── entity/(...)
  │   │   │   ├── repository/(...)
  │   │   │   ├── service/(...)
  │   │   │   └── PropertyManagementApplication.java
  │   │   ├── resources/
  │   │   │   ├── application.properties
  │   │   │   ├── templates/
  │   │   │   └── static/
  │   │   └── jte/
  │   └── test/
  └── mvnw, mvnw.cmd
```

## Gereksinimler
- Java 21 (JDK 21)
- Maven 3.9+
- PostgreSQL 14+ (yerel kurulum)

## Kurulum
1. Depoyu klonlayın:
```bash
git clone <repo-url>
cd property-management
```
2. Bağımlılıkları indirin ve derleyin:
```bash
mvn clean package -DskipTests
```

## Yapılandırma
Uygulama yapılandırması `src/main/resources/application.properties` dosyasındadır.

Varsayılan veritabanı ayarları:
```properties
gg.jte.development-mode=true
spring.application.name=property-management

# database connection
spring.datasource.url=jdbc:postgresql://localhost:5432/postgres
spring.jpa.properties.hibernate.default_schema=property_db
spring.datasource.username=postgres
spring.datasource.password=User.2025

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
```
- **Önemli**: `spring.datasource.url/username/password` değerlerini kendi ortamınıza göre değiştirin. `default_schema` (örn. `property_db`) şemanız yoksa PostgreSQL üzerinde oluşturun veya bu satırı kaldırın.
- `spring.jpa.hibernate.ddl-auto=update` geliştirme için uygundur. Üretimde `validate` ya da migrosyon aracı (Flyway/Liquibase) tercih edilmelidir.

## Çalıştırma
- Maven ile çalıştırma:
```bash
mvn spring-boot:run
```
- Jar ile çalıştırma:
```bash
java -jar target/property-management-0.0.1-SNAPSHOT.jar
```
- Varsayılan port: `8080`

## API
Tüm uçlar `application/json` içerik türünü kullanır ve `/rest/api/...` taban yolunu izler. Aşağıda başlıca kaynaklar listelenmiştir.

### Daire (Apartment)
Taban yol: `/rest/api/apartment`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

Örnek istek gövdesi (`POST /save`):
```json
{
  "number": "A12",
  "type": "2+1",
  "allotmentPercentage": 12.5,
  "residentId": 1
}
```

### Sakin (Resident)
Taban yol: `/rest/api/resident`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

Örnek istek gövdesi (`POST /save`):
```json
{
  "name": "John Doe",
  "type": "Owner",
  "phone": "+90 555 000 00 00",
  "email": "john@doe.com",
  "dtoApartmentId": 1
}
```

### Mülk (Property)
Taban yol: `/rest/api/property`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Fatura (Billing)
Taban yol: `/rest/api/billings`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Aidat (Dues)
Taban yol: `/rest/api/dues`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Demirbaş (Fixture)
Taban yol: `/rest/api/fixture`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Demirbaş Gider (FixtureFee)
Taban yol: `/rest/api/fixturefee`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

### Demirbaş Gider Payı (FixtureFeeShare)
Taban yol: `/rest/api/fixturefeeshare`
- `POST /save`
- `GET /list`
- `GET /list/{id}`
- `PUT /update/{id}`
- `DELETE /delete/{id}`

## Örnek İstek/Response
- Daire oluşturma (cURL):
```bash
curl -X POST http://localhost:8080/rest/api/apartment/save \
  -H "Content-Type: application/json" \
  -d '{
    "number": "A12",
    "type": "2+1",
    "allotmentPercentage": 12.5,
    "residentId": 1
  }'
```
- Başarısız doğrulama durumunda `GlobalExceptionHandler` üzerinden anlamlı hata mesajları dönülür.

## Geliştirme İpuçları
- `DevTools` etkin, kod değişikliklerinde otomatik yeniden başlatma sağlar.
- `spring.jpa.show-sql=true` ile SQL loglarını takip edebilirsiniz.
- JTE şablonları `src/main/jte` altında, maven eklentisi derleme sırasında şablonları üretir.

## Testler
```bash
mvn test
```

## Lisans
Bu proje kişisel/öğrenme amaçlıdır. Dilediğiniz gibi kullanabilirsiniz. Resmi bir lisans eklemek isterseniz `LICENSE` dosyası oluşturun.

## Yazar
- Erdem Yusuf 